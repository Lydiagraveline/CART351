<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Heaven</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body style="background-image: url('images/heaven.png'); background-size: 100% 100%;">
    <div id="options" style="margin:10px;">
    <p class="fakeLink">
    <span id="clickToApologize">CLICK to apologize!</span> <br/>
    <span id="clickToBeSaved">CLICK to be saved!</span> <br/>
    <span id="clickToForgive">CLICK to forgive!</span> <br/>
    <span id="clickToForget">CLICK to forget!</span> <br/>
    <a href="circuit.html">CLICK to be pure!</a> <br/>
  </p>
  </div>

  <!-- apologize form-->
  <form id="apologizeForm" style="display:none;">
    <div class="form">
    <h2>APOLOGIZE HERE!</h2>
    <label for="apologize"> Here is a space to apologize. Yours will be added to a master list, anonymously. </label> <br>
    <input type="text" id="apologize" name="apologize" required> <br>
    <input type="submit" name="submit" value="submit"/>
    <input type="button" onclick="location.href='heaven.html';" value="nevermind"/>
  </div>
  <div class="sent" style="display:none;">
    <p>Your apology has been sent! You will be forgiven in the next 5-10 business days. </p>
    <input type="button" onclick="location.href='heaven.html';" value="ok" />
  </div>
</form>

<!-- be saved form -->
<form id="saveForm" style="display:none;">
  <div class="form">
    <h2>Save your spot, make your mark!</h2>
    <label for="save">Submit your name to reserve a spot. Your name will be displayed online.</label> <br>
    <input type="text" id="save" name="save" required /><br>
    <input type="submit" name="submit" value="submit"/>
    <input type="button" onclick="location.href='heaven.html';" value="nevermind"/>
  </div>
  <div class="sent" style="display:none;">
    <p>Your submission has been received!</p>
    <input type="button" onclick="location.href='heaven.html';" value="ok" />
    <input type="button" onclick="location.href='earth.html';" value="i want to see it" />
  </div>
</form>

<!-- forgive form -->
<form id="forgiveForm" style="display:none;">
  <div class="form">
    <h2>FORGIVE NOW!</h2>
    <label for="forgive"> Who and what are you forgiving? Yours will be added to a master list, anonymously. </label> <br>
    <input type="text" id="forgive" name="forgive" required/> <br>
    <input type="submit" name="submit" value="submit"/>
    <input type="button" onclick="location.href='heaven.html';" value="nevermind"/>
  </div>
  <div class="sent" style="display:none;">
    <p>Your submission has been received!</p>
    <input type="button" onclick="location.href='heaven.html';" value="ok" />
  </div>
</form>

<!-- forget form -->
<form id="forgetForm" style="display:none;">
  <div class="form">
    <h2>FORGET NOW!</h2>
    <label for="forget"> What are you trying to forget? Yours will be added to a master list, anonymously. </label> <br>
    <input type="text" id="forget" name="forget" required/> <br>
    <input type="submit" name="submit" value="submit"/>
    <input type="button" onclick="location.href='heaven.html';" value="nevermind"/>
  </div>
  <div class="sent" style="display:none;">
    <p>Your submission has been received! You will forget in the next 5-10 business days.</p>
    <input type="button" onclick="location.href='heaven.html';" value="ok" />
  </div>
</form>
  
<!-- </div> -->
    <script>
      $(document).ready (function() {
      
        //open each form on click
      $("#clickToApologize").click(function(){
        showForm("#apologizeForm");
      })

      $("#clickToBeSaved").click(function(){
        showForm("#saveForm");
      })

      $("#clickToForgive").click(function(){
        showForm("#forgiveForm");
      })

      $("#clickToForget").click(function(){
        showForm("#forgetForm");
      })

       // submit each form
        submitForm("#apologizeForm");
        submitForm("#saveForm");
        submitForm("#forgiveForm");
        submitForm("#forgetForm");

        

      }) //document ready

      //submit a form when the button is pressed
      function submitForm(form){
        $(form).submit(function(event){
            event.preventDefault();
             //turn the data into an array
            let data =$(form).serializeArray();
            for(let valuePairs of data.entries()) {
            //  console.log(valuePairs[0]+ ', ' + valuePairs[1]);
             }

            //hide the form once submitted
            $(".form").hide();
            $(".sent").show();

             //send to ajax
             sendData(data);
            })//submit form
      }

      //display the form
      function showForm(form){
        $("#options").hide();
        $(form).show();
      }

      function sendData(data){
                //request
                $.ajax({
            type:"GET",
            url: "php/submit.php",
            data: data,
            dataType: "text",
            cache: false,
            timeout: 600000,
            success: function(response){
                console.log(response);
                console.log("success!");
            }, //success
            error: function(){
                console.log("error occured");
            }//error
        }) //ajax
        //window.open("submissions.php");
      }

      const heavenCheckBox = localStorage.getItem("heaven-check");

      var heavenValues = JSON.parse(localStorage.getItem("heavenValues")) || {},
        $checkboxes = $("#checkbox-container :checkbox");

      $checkboxes.on("change", function () {
        $checkboxes.each(function () {
          heavenValues[this.id] = this.checked;
        });
        localStorage.setItem("heavenValues", JSON.stringify(heavenValues));
      });

      // On page load
      $.each(heavenValues, function (key, value) {
        $("#" + key).prop("checked", value);
      });
    </script>
  </body>
</html>
